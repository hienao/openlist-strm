<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hienao.openlist2strm.mapper.PermissionMapper">

  <resultMap id="BaseResultMap" type="Permission">
    <id column="id" property="id" jdbcType="BIGINT"/>
    <result column="code" property="code" jdbcType="VARCHAR"/>
    <result column="name" property="name" jdbcType="VARCHAR"/>
    <result column="create_time" property="createTime" jdbcType="TIMESTAMP"/>
    <result column="update_time" property="updateTime" jdbcType="TIMESTAMP"/>
  </resultMap>

  <select id="findById" resultMap="BaseResultMap">
    SELECT id, code, name, create_time, update_time
    FROM permission
    WHERE id = #{id}
  </select>

  <select id="findByCode" resultMap="BaseResultMap">
    SELECT id, code, name, create_time, update_time
    FROM permission
    WHERE code = #{code}
  </select>

  <select id="findByCodeIn" resultMap="BaseResultMap">
    SELECT id, code, name, create_time, update_time
    FROM permission
    WHERE code IN
    <foreach item="code" collection="list" open="(" separator="," close=")">
      #{code}
    </foreach>
  </select>

  <select id="findByIdIn" resultMap="BaseResultMap">
    SELECT id, code, name, create_time, update_time
    FROM permission
    WHERE id IN
    <foreach item="id" collection="list" open="(" separator="," close=")">
      #{id}
    </foreach>
  </select>

  <select id="findByCodeContainingAndNameContaining" resultMap="BaseResultMap">
    SELECT id, code, name, create_time, update_time
    FROM permission
    <where>
      <if test="code != null and code != ''">
        code LIKE '%' || #{code} || '%'
      </if>
      <if test="name != null and name != ''">
        AND name LIKE '%' || #{name} || '%'
      </if>
    </where>
    LIMIT #{limit} OFFSET #{offset}
  </select>

  <select id="countByCodeContainingAndNameContaining" resultType="long">
    SELECT COUNT(*)
    FROM permission
    <where>
      <if test="code != null and code != ''">
        code LIKE '%' || #{code} || '%'
      </if>
      <if test="name != null and name != ''">
        AND name LIKE '%' || #{name} || '%'
      </if>
    </where>
  </select>

  <insert id="save" useGeneratedKeys="true" keyProperty="id">
    INSERT INTO permission (code, name, create_time, update_time)
    VALUES (#{code}, #{name}, #{createTime}, #{updateTime})
  </insert>

  <update id="update">
    UPDATE permission
    SET code = #{code},
        name = #{name},
        update_time = #{updateTime}
    WHERE id = #{id}
  </update>

  <delete id="deleteById">
    DELETE FROM permission WHERE id = #{id}
  </delete>

  <select id="findAll" resultMap="BaseResultMap">
    SELECT id, code, name, create_time, update_time
    FROM permission
  </select>

</mapper>