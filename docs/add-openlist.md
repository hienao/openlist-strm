# 添加 OpenList 配置

OpenList 配置是连接您的 OpenList 服务器和 STRM 转换任务的桥梁。本页详细介绍如何添加和管理 OpenList 配置。

## 什么是 OpenList 配置？

OpenList 配置包含了连接到您的 OpenList 服务器所需的所有信息：

- 服务器地址（Base URL）
- 认证令牌（Token）
- STRM Base URL（可选）
- URL 编码设置

## 添加新配置

### 第一步：访问配置页面

1. 登录 OpenList to Stream 系统
2. 在首页点击 **"添加配置"** 按钮

### 第二步：填写配置信息

#### Base URL
填写您的 OpenList 服务器地址：

**格式示例：**
- `http://192.168.1.100:5244`（局域网地址）
- `https://openlist.example.com`（域名）
- `http://localhost:5244`（本地部署）

::: tip 注意事项
- 地址必须包含协议（http:// 或 https://）
- 确保端口号正确（默认：5244）
- 如果使用域名，确保域名可以正常解析
:::

#### Token
填写 OpenList 的访问令牌：

**获取方式：**
1. 登录您的 OpenList 服务器
2. 进入设置页面或 API 配置页面
3. 复制生成的 Token

::: warning 安全提醒
- Token 相当于密码，请妥善保管
- 建议定期更换 Token
- 不要在不安全的环境中分享 Token
:::

#### STRM Base URL（可选）
用于替换 STRM 文件中的原始 URL：

**使用场景：**
- 媒体服务器与 OpenList 服务器部署在不同地址
- 需要通过内网地址访问媒体文件
- 使用 CDN 加速访问

**示例：**
- 留空：使用原始 OpenList 地址
- `https://media-server.local`：使用内网媒体服务器地址
- `https://cdn.example.com`：使用 CDN 地址

### 第三步：测试连接

填写完配置后，点击 **"测试连接"** 按钮：

**✅ 连接成功**
- 显示绿色成功提示
- 可以看到服务器版本信息
- 可以继续保存配置

**❌ 连接失败**
- 显示红色错误提示
- 检查以下可能的问题：
  - 服务器地址是否正确
  - 网络连接是否正常
  - Token 是否正确且有效
  - 服务器是否正在运行
  - Token 是否有足够的权限访问指定路径

### 第四步：保存配置

连接测试成功后，点击 **"保存"** 按钮完成配置创建。

## 管理现有配置

### 查看配置列表
在配置页面可以看到所有已添加的配置：

| 配置名称 | 服务器地址 | 状态 | 操作 |
|----------|------------|------|------|
| 家庭媒体服务器 | http://192.168.1.100:5244 | ✅ 正常 | 编辑/删除/测试 |
| 电影库 | https://movies.example.com | ❌ 失败 | 编辑/删除/测试 |

### 编辑配置
1. 在配置列表中找到要编辑的配置
2. 点击右侧的 **"编辑"** 按钮
3. 修改配置信息
4. 点击 **"测试连接"** 验证
5. 点击 **"保存"** 确认修改

### 删除配置
1. 在配置列表中找到要删除的配置
2. 点击右侧的 **"删除"** 按钮
3. 在确认对话框中点击 **"确认删除"**

::: danger 删除警告
删除配置后，所有使用该配置的任务将无法正常工作。请确保没有任务正在使用该配置。
:::

### 测试配置
1. 在配置列表中找到要测试的配置
2. 点击右侧的 **"测试"** 按钮
3. 查看测试结果

## 常见连接问题

### 问题 1：连接超时
**可能原因：**
- 网络连接问题
- 服务器地址错误
- 防火墙阻止连接

**解决方法：**
1. 检查网络连接
2. 验证服务器地址和端口
3. 检查防火墙设置

### 问题 2：认证失败
**可能原因：**
- Token 错误或已过期
- Token 权限不足
- Token 格式不正确

**解决方法：**
1. 重新生成或复制 Token
2. 检查 Token 是否有足够的访问权限
3. 确认 Token 没有过期
4. 验证 Token 格式是否正确

### 问题 3：SSL 证书错误
**可能原因：**
- 使用自签名证书
- 证书过期

**解决方法：**
1. 禁用 SSL 验证（仅测试环境）
2. 更新证书
3. 使用有效的 SSL 证书

## 最佳实践

### 1. 命名规范
使用描述性的配置名称：
- ✅ `家庭电影库-阿里云盘`
- ✅ `电视剧库-NAS`
- ❌ `配置1`
- ❌ `test`

### 2. 网络优化
- 优先使用局域网地址（更快）
- 确保网络连接稳定
- 考虑使用 CDN 加速

### 3. 安全考虑
- 定期更新 Token
- 确保 Token 安全，避免泄露
- 启用 HTTPS（如可能）
- 为 Token 设置合适的权限范围

### 4. 备份配置
定期备份重要的配置信息，以防意外丢失。

## 在任务中使用配置

配置创建后，可以通过以下方式使用：

1. 在首页的配置列表中，找到对应的配置
2. 点击操作列中的 **"管理任务"** 按钮
3. 在任务管理页面中创建和管理转换任务
4. 任务会自动使用关联的 OpenList 配置

## 故障排除

### 查看连接日志
在系统日志中可以查看详细的连接信息：
1. 访问 [日志页面](./log.md)
2. 筛选 "OpenList 连接" 相关日志
3. 查看具体的错误信息

### 联系支持
如果问题仍未解决，可以：
1. 查看 [常见问题](./faq.md)
2. 在 [GitHub Issues](https://github.com/hienao/openlist-strm/issues) 提交问题
3. 提供详细的错误信息和配置内容

---

现在您已经学会了如何添加和管理 OpenList 配置，接下来可以 [创建您的第一个转换任务](./add-task.md)。