# AI 识别配置

AI 文件名识别功能通过人工智能技术帮助提高 TMDB 刮削的准确性，特别适用于文件名不规范或包含特殊字符的媒体文件。

## 功能概述

AI 识别功能会在执行刮削任务时，使用 AI 模型来分析和标准化文件名，从而提高 TMDB 匹配的准确率：

- 🤖 **智能文件名识别**：自动解析和标准化复杂的文件名
- 🎯 **提高匹配准确率**：显著改善 TMDB 刮削的成功率
- 🔧 **自定义识别规则**：通过提示词自定义识别逻辑
- ⚡ **性能控制**：支持请求频率限制，避免 API 超限

## 配置界面

### 访问方式
1. 登录系统
2. 点击顶部导航栏的 **"系统设置"**
3. 找到 **"AI 文件名识别设置"** 部分

## 配置选项详解

### 1. 启用 AI 文件名识别
**功能说明**：总开关，控制是否启用 AI 识别功能

**效果**：
- ✅ **启用**：在刮削时使用 AI 分析文件名
- ❌ **禁用**：使用传统的文件名解析方式

**提示**：启用后会显示额外的配置选项

### 2. API 基础 URL
**功能说明**：AI 服务的 API 接口地址

**默认值**：`https://api.openai.com/v1`

**配置示例**：
- **OpenAI 官方**：`https://api.openai.com/v1`
- **Azure OpenAI**：`https://your-resource.openai.azure.com/openai/deployments/your-deployment`
- **兼容服务**：其他兼容 OpenAI API 格式的服务地址

### 3. API Key
**功能说明**：访问 AI 服务的认证密钥

**格式要求**：
- OpenAI：以 `sk-` 开头
- Azure：特定的 API 密钥格式

**安全建议**：
- 🔒 妥善保管 API Key，避免泄露
- 🔄 定期更换 API Key
- 💰 为 API Key 设置合适的消费限制

### 4. 模型名称
**功能说明**：指定使用的 AI 模型

**推荐模型**：
- `gpt-3.5-turbo`：性价比高，响应快速
- `gpt-4`：识别准确率更高，成本较高
- `gpt-4-turbo`：平衡性能和成本

**选择建议**：
- **日常使用**：推荐 `gpt-3.5-turbo`
- **高精度需求**：选择 `gpt-4` 系列
- **兼容服务**：使用服务支持的模型名称

### 5. QPM 限制
**功能说明**：每分钟最大请求数限制

**作用**：
- 🛡️ **防止 API 超限**：避免触发 API 频率限制
- 💰 **成本控制**：控制 API 调用费用
- ⚖️ **负载均衡**：合理分配请求时间

**推荐设置**：
- **OpenAI 免费账户**：20-40
- **OpenAI 付费账户**：60-200
- **其他服务**：根据服务限制设置

### 6. 提示词
**功能说明**：定义 AI 如何识别和标准化文件名的指令

**默认提示词**：系统提供经过优化的默认提示词

**自定义提示词**：
- 可以根据特殊需求自定义识别规则
- 支持多语言识别指令
- 可以指定特定的命名规范

**提示词编写建议**：
```
请分析以下媒体文件名，提取出标准化的电影或电视剧信息：
- 识别标题、年份、季、集等关键信息
- 标准化命名格式
- 去除不必要的标记和广告信息
返回 JSON 格式的结构化数据
```

## 操作功能

### 测试配置
**功能**：验证 AI 配置是否正确

**操作步骤**：
1. 完成所有必要配置
2. 点击 **"测试配置"** 按钮
3. 等待测试结果

**测试结果**：
- ✅ **成功**：显示 "AI 配置测试成功"
- ❌ **失败**：显示具体的错误信息

**常见失败原因**：
- API Key 错误或无效
- 网络连接问题
- API 服务不可用
- 请求频率超限

### 重置提示词
**功能**：将自定义提示词恢复为系统默认值

**操作**：
1. 点击 **"重置为默认"** 按钮
2. 确认重置操作
3. 系统自动恢复默认提示词

## 使用场景

### 1. 文件名不规范
**问题**：文件名包含大量特殊字符、广告信息或非标准格式
**解决方案**：AI 识别可以自动清理和标准化文件名

**示例**：
```
原文件名：[电影天堂www.dy2018.com]复仇者联盟4：终局之战.2019.1080p.BluRay.x264-CMCT.mkv
AI 识别后：复仇者联盟4：终局之战 (2019)
```

### 2. 多语言混合
**问题**：文件名包含中文、英文、数字混合，难以准确识别
**解决方案**：AI 可以理解多语言内容并提取关键信息

**示例**：
```
原文件名：Avengers.Endgame.2019.1080p.BluRay.x264-SPARKS.复仇者联盟4.mkv
AI 识别后：Avengers: Endgame (2019) / 复仇者联盟4：终局之战
```

### 3. 特殊标记处理
**问题**：文件名包含制作组标记、质量标签等干扰信息
**解决方案**：AI 可以过滤无关信息，保留核心媒体信息

**示例**：
```
原文件名：[YYDS.Rips]蜘蛛侠：英雄无归.2021.4K.HDR.BluRay.2160p.DTS-HD.MA.7.1.x265.10bit-BDMV.mkv
AI 识别后：蜘蛛侠：英雄无归 (2021)
```

## 性能优化

### 1. QPM 设置优化
**原则**：在保证识别效果的前提下，合理控制请求频率

**建议设置**：
- **小规模使用**：20-40 QPM
- **中等规模**：60-100 QPM
- **大规模部署**：100-200 QPM

### 2. 模型选择优化
**成本考虑**：
- `gpt-3.5-turbo`：成本约为 `gpt-4` 的 1/10
- 适合批量文件处理场景

**准确率考虑**：
- `gpt-4`：复杂文件名识别准确率更高
- 适合高价值媒体文件处理

### 3. 提示词优化
**简洁高效**：
- 避免过于复杂的提示词
- 明确指定输出格式
- 减少不必要的上下文

## 故障排除

### 常见问题及解决方案

**问题 1：AI 配置测试失败**
**可能原因**：
- API Key 错误或已过期
- 网络连接问题
- API 服务不可用

**解决方法**：
1. 验证 API Key 是否正确
2. 检查网络连接
3. 确认 API 服务状态

**问题 2：识别效果不佳**
**可能原因**：
- 提示词不够明确
- 模型选择不当
- 文件名过于复杂

**解决方法**：
1. 优化提示词内容
2. 尝试更强大的模型
3. 手动调整极端情况

**问题 3：API 费用过高**
**可能原因**：
- QPM 设置过高
- 使用了高成本模型
- 处理了大量文件

**解决方法**：
1. 降低 QPM 限制
2. 选择性价比更高的模型
3. 仅对必要文件启用 AI 识别

## 最佳实践

### 1. 渐进式启用
- 先在小范围内测试效果
- 逐步扩大使用范围
- 持续监控识别效果和成本

### 2. 成本控制
- 设置合理的 QPM 限制
- 选择合适的模型
- 定期检查 API 使用情况

### 3. 质量监控
- 定期检查识别结果
- 收集识别失败的案例
- 持续优化提示词

### 4. 备份方案
- 保留传统文件名解析方式
- 在 AI 服务不可用时自动降级
- 确保系统稳定性

---

通过合理配置 AI 识别功能，可以显著提升媒体文件刮削的准确率和效率。如有其他问题，请查看 [常见问题](./faq.md) 或联系技术支持。